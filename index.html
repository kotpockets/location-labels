<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Location Label Maker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    padding: 12px;
    margin: 0;
    background: #f5f5f5;
  }
  .container {
    max-width: 520px;
    margin: 0 auto;
    background: #fff;
    padding: 14px;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  }
  h2 {
    font-size: 20px;
    text-align: center;
    margin: 0 0 12px;
  }
  .field {
    margin-bottom: 10px;
  }
  label {
    font-size: 13px;
    font-weight: 600;
    display: block;
    margin-bottom: 3px;
  }
  input {
    width: 100%;
    padding: 9px 10px;
    font-size: 16px;
    border-radius: 8px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
  .buttons {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 8px;
  }
  button {
    padding: 12px;
    font-size: 17px;
    border-radius: 999px;
    border: none;
  }
  button.primary {
    background: #111;
    color: #fff;
  }
  button.secondary {
    background: #eee;
    color: #111;
    border: 1px solid #ccc;
  }
  #labelCanvas {
    width: 100%;
    max-width: 100%;
    display: block;
    margin: 14px auto 4px;
    border-radius: 8px;
    background: #fff;
    border: 1px solid #ddd;
  }
  .hint {
    font-size: 11px;
    text-align: center;
    color: #666;
  }
</style>
</head>
<body>

<div class="container">
  <h2>Location Label Maker (2×4)</h2>

  <div class="field">
    <label for="zone">Zone</label>
    <input id="zone" inputmode="numeric" autocomplete="off">
  </div>
  <div class="field">
    <label for="dept">Dept</label>
    <input id="dept" autocomplete="off">
  </div>
  <div class="field">
    <label for="aisle">Aisle</label>
    <input id="aisle" autocomplete="off">
  </div>
  <div class="field">
    <label for="side">Side</label>
    <input id="side" autocomplete="off">
  </div>
  <div class="field">
    <label for="seg">Seg</label>
    <input id="seg" inputmode="numeric" autocomplete="off">
  </div>

  <div class="buttons">
    <button class="primary" onclick="updatePreview()">Update Preview</button>
    <button class="secondary" onclick="downloadPng()">Download PNG</button>
  </div>

  <canvas id="labelCanvas" width="1200" height="600"></canvas>
  <div class="hint">
    PNG is 1200×600 for sharp 2×4 label printing. Fields left blank are skipped in text & QR.
  </div>
</div>

<!-- Local QR library (must sit in same folder as this HTML) -->
<script src="qrcode.min.js"></script>
<script>
function buildQrText(parts) {
  return parts
    .map(x => x.trim())
    .filter(x => x.length > 0)
    .map(x => x.toUpperCase())
    .join("-");
}

function drawDarkText(ctx, text, x, y) {
  ctx.lineWidth = 2;
  ctx.strokeStyle = "#000000";
  ctx.strokeText(text, x, y);
  ctx.fillStyle = "#000000";
  ctx.fillText(text, x, y);
}

function updatePreview() {
  const fields = {
    Zone:  document.getElementById('zone').value,
    Dept:  document.getElementById('dept').value,
    Aisle: document.getElementById('aisle').value,
    Side:  document.getElementById('side').value,
    Seg:   document.getElementById('seg').value
  };

  const qrText = buildQrText([
    fields.Zone,
    fields.Dept,
    fields.Aisle,
    fields.Side,
    fields.Seg
  ]);

  const canvas = document.getElementById("labelCanvas");
  const ctx = canvas.getContext("2d");

  // Background
  ctx.fillStyle = "#FFFFFF";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Text
  ctx.font = 'bold 56px "Courier New", monospace';
  let y = 150;
  const line = 80;
  const left = 90;

  for (const [label, val] of Object.entries(fields)) {
    if (val.trim().length > 0) {
      drawDarkText(ctx, `${label.padEnd(5)} ${val.toUpperCase()}`, left, y);
      y += line;
    }
  }

  // QR code
  const temp = document.createElement("div");
  temp.style.position = "absolute";
  temp.style.left = "-9999px";
  document.body.appendChild(temp);

  const qrSize = 380;
  new QRCode(temp, {
    text: qrText || " ",   // avoid empty text crash
    width: qrSize,
    height: qrSize,
    correctLevel: QRCode.CorrectLevel.L
  });

  setTimeout(() => {
    const img = temp.querySelector("img") || temp.querySelector("canvas");
    if (img) {
      const qrX = 720;
      const qrY = 110;
      ctx.drawImage(img, qrX, qrY, qrSize, qrSize);
    }
    temp.remove();
  }, 80);
}

function downloadPng() {
  const canvas = document.getElementById("labelCanvas");
  const link = document.createElement("a");
  link.href = canvas.toDataURL("image/png");
  link.download = "location-label.png";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// Initial preview so you see the canvas
updatePreview();
</script>
</body>
</html>
